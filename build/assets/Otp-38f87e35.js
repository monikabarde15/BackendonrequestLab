import{t as E,r as n,j as p,a as r,Z as C,a0 as j,y as o,b as O}from"./index-8c252e2a.js";const I=()=>{const P=E(),[i,h]=n.useState(""),[d,b]=n.useState(""),[y,x]=n.useState(!1),[m,v]=n.useState(!1),[T,f]=n.useState(!0),[w,u]=n.useState(!1),N=e=>{var s;const t=`; ${document.cookie}`.split(`; ${e}=`);return t.length===2?(s=t.pop())==null?void 0:s.split(";").shift():null};n.useEffect(()=>{const e=N("email");e&&h(e)},[]);const k=async()=>{var e,l,t,s,c;if(!i.trim()){o.error("Please enter your email.",{position:"top-center"});return}v(!0);try{const a=await O.post("https://backend.onrequestlab.com/api/v1/users/auth/resend-otp/",{email:i},{headers:{"Content-Type":"application/json"}});o.success(((e=a.data)==null?void 0:e.message)||"OTP has been sent!",{position:"top-center"}),f(!0),u(!1),b("")}catch(a){const g=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||((c=(s=a.response)==null?void 0:s.data)==null?void 0:c.error)||"Failed to send OTP.";o.error(g,{position:"top-center"})}finally{v(!1)}},S=async e=>{var l,t,s,c;if(e.preventDefault(),!d.trim()){o.error("Please enter OTP.",{position:"top-center"});return}if(!i.trim()){o.error("Email is missing.",{position:"top-center"}),f(!1),u(!0);return}x(!0);try{const a=await O.post("https://backend.onrequestlab.com/api/v1/users/auth/verify-otp/",{email:i,otp:d},{headers:{"Content-Type":"application/json"}});o.success("OTP verified successfully!",{position:"top-center"}),u(!1),setTimeout(()=>P("/login"),1200)}catch(a){const g=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||((c=(s=a.response)==null?void 0:s.data)==null?void 0:c.error)||"OTP verification failed.";o.error(g,{position:"top-center"}),u(!0),f(!1)}finally{x(!1)}};return p("div",{className:"relative flex min-h-screen items-center justify-center bg-[url(/assets/images/auth/map.png)] bg-cover bg-center px-6 py-10 dark:bg-[#060818] sm:px-16",children:[p("div",{className:"relative w-full max-w-[420px] rounded-lg bg-white/80 p-8 dark:bg-black/60 backdrop-blur-md shadow-lg",children:[r("h1",{className:"text-3xl font-extrabold text-primary mb-6 uppercase text-center",children:C.t("Verify OTP")}),T?p("form",{onSubmit:S,className:"space-y-4",children:[p("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:["OTP sent to ",r("b",{children:decodeURIComponent(i)})]}),r("input",{type:"text",placeholder:"Enter OTP",className:"form-input w-full",value:d,onChange:e=>b(e.target.value)}),r("button",{type:"submit",disabled:y,className:"btn btn-gradient w-full",children:y?"Verifying...":"Verify OTP"})]}):p("div",{className:"space-y-4",children:[w&&r("p",{className:"text-red-500 text-center",children:"OTP expired or invalid. Please resend OTP."}),r("input",{type:"email",placeholder:"Enter your email",className:"form-input w-full",value:i,onChange:e=>h(e.target.value)}),r("button",{type:"button",onClick:k,disabled:m,className:`btn btn-gradient w-full ${m?"opacity-60 cursor-not-allowed":""}`,children:m?"Sending...":"Resend OTP"})]})]}),r(j,{autoClose:2e3,theme:"colored"})]})};export{I as default};
