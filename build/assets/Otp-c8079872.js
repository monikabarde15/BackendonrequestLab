import{t as O,r as o,y as l,Z as e,j as r,a as s,a0 as P,b as C}from"./index-3a453257.js";import{I as j}from"./IconLockDots-e42b2164.js";const A=()=>{const p=O(),[c,v]=o.useState(""),[d,m]=o.useState(""),[u,g]=o.useState(!1),[w,_]=o.useState(!1),[h,N]=o.useState(""),[I,T]=o.useState("");o.useEffect(()=>{const t=JSON.parse(sessionStorage.getItem("formData")||"{}");t!=null&&t.email?N(t.email):(l.error(e.t("No email found, please register again."),{position:"top-center"}),p("/otp"));const n=sessionStorage.getItem("access_token");n&&T(n)},[p]);const S=async t=>{var n,i,f,b,x,y;if(t.preventDefault(),m(""),!c.trim()){m(e.t("Please enter OTP."));return}g(!0);try{const a=await C.post("https://backend.onrequestlab.com/api/v1/users/auth/verify-otp/",{email:h,otp:c},{headers:{"Content-Type":"application/json"}}),k=a.data;a.data.message=="Email already verified"?(l.error(a.data.message),setTimeout(()=>{window.location.href="/login"},1200)):(l.success(e.t("âœ… Email verified successfully!"),{position:"top-center",style:{background:"#4CAF50",color:"white",fontWeight:"bold",borderRadius:"8px"}}),setTimeout(()=>{window.location.href="/login"},1200))}catch(a){console.error(a);const k=((i=(n=a.response)==null?void 0:n.data)==null?void 0:i.message)||((b=(f=a.response)==null?void 0:f.data)==null?void 0:b.detail)||((y=(x=a.response)==null?void 0:x.data)==null?void 0:y.error)||"Something went wrong.";l.error(e.t(k),{position:"top-center"})}finally{g(!1)}},E=(t=>{const i=`; ${document.cookie}`.split(`; ${t}=`);return i.length===2?i.pop().split(";").shift():null})("access");return console.log("accessToken=",E),r("div",{className:"relative flex min-h-screen items-center justify-center bg-[url(/assets/images/auth/map.png)] bg-cover bg-center px-6 py-10 dark:bg-[#060818] sm:px-16",children:[r("div",{className:"relative w-full max-w-[420px] rounded-lg bg-white/80 p-8 dark:bg-black/60 backdrop-blur-md shadow-lg",children:[s("h1",{className:"text-3xl font-extrabold text-primary mb-6 uppercase text-center",children:e.t("Verify OTP")}),r("form",{onSubmit:S,className:"space-y-4",children:[r("p",{className:"text-center text-sm text-gray-600 dark:text-gray-300",children:[e.t("An OTP has been sent to")," ",s("b",{children:h})]}),r("div",{children:[s("label",{className:"block text-sm font-semibold",children:e.t("Enter OTP")}),r("div",{className:"relative",children:[s("input",{type:"text",name:"otp",value:c,onChange:t=>v(t.target.value),placeholder:e.t("Enter your OTP"),className:`form-input ps-10 w-full placeholder:text-white-dark ${d?"border-red-500":""}`}),s("span",{className:"absolute start-4 top-1/2 -translate-y-1/2 text-white-dark",children:s(j,{})})]}),d&&s("p",{className:"text-red-500 text-sm mt-1",children:d})]}),s("button",{type:"submit",disabled:u,className:"btn btn-gradient mt-6 w-full uppercase border-0 shadow-[0_10px_20px_-10px_rgba(67,97,238,0.44)]",children:u?e.t("Verifying..."):e.t("Verify OTP")})]}),r("div",{className:"text-center mt-6 text-sm dark:text-white",children:[e.t("Login")," ",r("a",{href:"/login",children:["  ",s("button",{type:"button",className:"text-primary font-semibold underline",children:w?e.t("Here..."):e.t("Here")})]})]})]}),s(P,{autoClose:2e3,theme:"colored"})]})};export{A as default};
