import{c as L,r,s as _,j as a,a as e,f as T,g as $,b as N}from"./index-3a453257.js";import{S as k}from"./sweetalert2.all-af2d037b.js";import{I as A}from"./IconListCheck-f7c74dbd.js";import{I as D}from"./IconLayoutGrid-5ad8ad1b.js";import{I as j}from"./IconFacebook-1acfe424.js";import{I as B}from"./IconInstagram-aead723b.js";import{I as E}from"./IconLinkedin-b475d8d4.js";import{I as z}from"./IconTwitter-5046fbc8.js";import{Y as h,y as w}from"./transition-2ed80f48.js";import"./keyboard-9109029c.js";import"./open-closed-2f6678f9.js";import"./hidden-20ea1f40.js";const C="https://backend.onrequestlab.com/api/v1/admin/feedback/",Q=()=>{const p=L(),[u,f]=r.useState(!1),[c,b]=r.useState("list"),[i,I]=r.useState(""),[o,g]=r.useState([]),[d,x]=r.useState([]),[F,y]=r.useState(!1),n=(t=>{const l=`; ${document.cookie}`.split(`; ${t}=`);if(l.length===2)return l.pop().split(";").shift()})("access"),S=async()=>{y(!0);try{const t=await N.get(C,{headers:n?{Authorization:`Bearer ${n}`}:{},withCredentials:!0}),s=Array.isArray(t.data.results)?t.data.results:[];g(s),x(s)}catch(t){console.error("Error fetching Feedback:",t),m("Failed to fetch Feedback","error")}finally{y(!1)}},v=async t=>{if((await k.fire({title:"Are you sure?",text:"This contact will be permanently deleted!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{await N.delete(`${C}${t.feedback_id}/`,{headers:n?{Authorization:`Bearer ${n}`}:{},withCredentials:!0}),g(o.filter(l=>l.feedback_id!==t.feedback_id)),m("Feedback deleted successfully!")}catch(l){console.error("Delete failed:",l),m("Failed to delete contact","error")}},m=(t,s="success")=>{k.fire({toast:!0,position:"top",showConfirmButton:!1,timer:2500,icon:s,title:t})};return r.useEffect(()=>{x(o.filter(t=>`${t.first_name} ${t.last_name}`.toLowerCase().includes(i.toLowerCase())))},[i,o]),r.useEffect(()=>{p(_("Contacts")),S()},[p]),a("div",{children:[a("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e("h2",{className:"text-xl font-semibold",children:"Feedback List"}),a("div",{className:"flex sm:flex-row flex-col sm:items-center sm:gap-3 gap-4 w-full sm:w-auto",children:[a("div",{className:"flex gap-3",children:[e("button",{type:"button",className:`btn btn-outline-primary p-2 ${c==="list"&&"bg-primary text-white"}`,onClick:()=>b("list"),children:e(A,{})}),e("button",{type:"button",className:`btn btn-outline-primary p-2 ${c==="grid"&&"bg-primary text-white"}`,onClick:()=>b("grid"),children:e(D,{})})]}),a("div",{className:"relative",children:[e("input",{type:"text",placeholder:"Search Feedback",className:"form-input py-2 ltr:pr-11 rtl:pl-11 peer",value:i,onChange:t=>I(t.target.value)}),e("button",{type:"button",className:"absolute ltr:right-[11px] rtl:left-[11px] top-1/2 -translate-y-1/2 peer-focus:text-primary",children:e(T,{className:"mx-auto"})})]})]})]}),c==="list"&&e("div",{className:"mt-5 panel p-0 border-0 overflow-hidden",children:e("div",{className:"table-responsive",children:a("table",{className:"table-striped table-hover",children:[e("thead",{children:a("tr",{children:[e("th",{children:"ID"}),e("th",{children:"Name"}),e("th",{children:"subject"}),e("th",{children:"description"}),e("th",{children:"Date"}),e("th",{className:"!text-center",children:"Actions"})]})}),e("tbody",{children:F?e("tr",{children:e("td",{colSpan:7,className:"text-center text-muted py-4",children:"Loading..."})}):d.length===0?e("tr",{children:e("td",{colSpan:7,className:"text-center text-muted py-4",children:"No feedback found."})}):d.map(t=>a("tr",{children:[e("td",{children:t.feedback_id}),e("td",{children:t.user}),e("td",{children:t.subject}),e("td",{children:t.description}),e("td",{children:new Date(t.timestamp).toLocaleString()}),e("td",{className:"text-center",children:e("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>v(t),children:"Delete"})})]},t.feedback_id))})]})})}),c==="grid"&&e("div",{className:"grid xl:grid-cols-3 sm:grid-cols-2 grid-cols-1 gap-6 mt-5",children:d.map(t=>a("div",{className:"bg-white dark:bg-[#1c232f] rounded-md p-5 shadow text-center relative",children:[a("h4",{className:"text-lg font-semibold mb-2",children:[t.first_name," ",t.last_name]}),e("p",{className:"text-sm text-gray-500 mb-1",children:t.email}),e("p",{className:"text-sm text-gray-500 mb-1",children:t.phone}),e("p",{className:"text-sm text-gray-600 italic mb-4 truncate",children:t.message}),a("div",{className:"flex justify-center space-x-3 mb-4",children:[e(j,{}),e(B,{}),e(E,{}),e(z,{})]}),e("button",{type:"button",className:"btn btn-outline-danger w-full",onClick:()=>v(t),children:"Delete"})]},t.feedback_id))}),e(h,{appear:!0,show:u,as:r.Fragment,children:a(w,{as:"div",open:u,onClose:()=>f(!1),className:"relative z-[51]",children:[e(h.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(h.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:a(w.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[e("button",{type:"button",onClick:()=>f(!1),className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",children:e($,{})}),e("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] py-3 px-5",children:"Add Contact"})]})})})})]})})]})};export{Q as default};
