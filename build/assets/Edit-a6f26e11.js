import{c as F,q as C,t as R,r as n,s as j,b as x,j as c,a as s}from"./index-3a453257.js";import{I as D}from"./IconSave-e9bb8cf2.js";import{z as P}from"./index-37c81567.js";const q=()=>{const p=F(),{id:l}=C(),N=R(),[v,m]=n.useState("/assets/images/cybblackpink.png"),[t,o]=n.useState({title:"",description:"",price:"",image:null}),[r,u]=n.useState({}),f=n.useRef(null),h=n.useRef(null),b=n.useRef(null);n.useEffect(()=>{p(j("Edit Expense")),l&&y(l)},[p,l]);const y=async e=>{try{const a=(await x.get(`https://cybitbackend.onrender.com/api/expenses/${e}`)).data.data;o({title:a.title,description:a.description,price:String(a.price),image:null}),m(a.image||"/assets/images/cybblackpink.png")}catch(i){console.error("Error fetching expense:",i),alert("Failed to load expense.")}},w=e=>{var a;const i=(a=e.target.files)==null?void 0:a[0];i&&(o({...t,image:i}),m(URL.createObjectURL(i)))},d=e=>{o({...t,[e.target.name]:e.target.value}),u({...r,[e.target.name]:""})},E=()=>{var i,a,g;let e={};return t.title.trim()||(e.title="Title is required"),t.description.trim()||(e.description="Description is required"),t.price.trim()||(e.price="Price is required"),u(e),Object.keys(e).length>0?(e.title?(i=f.current)==null||i.focus():e.description?(a=h.current)==null||a.focus():e.price&&((g=b.current)==null||g.focus()),!1):!0},k=async()=>{if(E())try{const e=new FormData;e.append("title",t.title),e.append("description",t.description),e.append("price",t.price),t.image&&e.append("image",t.image),(await x.put(`https://cybitbackend.onrender.com/api/expenses/${l}`,e,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&setTimeout(()=>{P.success("Expense updated successfully "),N("/apps/expenses/list")},1e3)}catch(e){console.error("Error updating expense:",e),alert("Failed to update expense.")}};return c("div",{className:"panel max-w-2xl mx-auto p-6 shadow-lg rounded-xl bg-white dark:bg-gray-800",children:[c("div",{className:"flex flex-col items-center mb-6",children:[s("img",{src:v,alt:"Preview",className:"w-28 h-28 object-cover rounded-xl border shadow-md mb-4"}),c("label",{className:"cursor-pointer px-6 py-2 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700 transition",children:["Upload Image",s("input",{type:"file",accept:"image/*",onChange:w,className:"hidden"})]})]}),c("div",{className:"mb-4",children:[s("label",{htmlFor:"title",className:"block font-medium mb-1",children:"Title"}),s("input",{id:"title",name:"title",type:"text",ref:f,value:t.title,onChange:d,className:`form-input w-full ${r.title?"border-red-500":""}`,placeholder:"Enter title"}),r.title&&s("p",{className:"text-red-500 text-sm mt-1",children:r.title})]}),c("div",{className:"mb-4",children:[s("label",{htmlFor:"description",className:"block font-medium mb-1",children:"Description"}),s("textarea",{id:"description",name:"description",ref:h,value:t.description,onChange:d,className:`form-textarea w-full min-h-[100px] ${r.description?"border-red-500":""}`,placeholder:"Write description..."}),r.description&&s("p",{className:"text-red-500 text-sm mt-1",children:r.description})]}),c("div",{className:"mb-6",children:[s("label",{htmlFor:"price",className:"block font-medium mb-1",children:"Price"}),s("input",{id:"price",name:"price",type:"number",ref:b,value:t.price,onChange:d,className:`form-input w-full ${r.price?"border-red-500":""}`,placeholder:"Enter price"}),r.price&&s("p",{className:"text-red-500 text-sm mt-1",children:r.price})]}),s("div",{className:"flex justify-center",children:c("button",{type:"button",className:"btn btn-success px-8 py-2 text-lg rounded-lg shadow-md",onClick:k,children:[s(D,{className:"mr-2 shrink-0"})," Update"]})})]})};export{q as default};
