import{r as i,b as m,j as o,a as t}from"./index-3a453257.js";const S=()=>{const[p,y]=i.useState([]),[r,l]=i.useState(null),[s,h]=i.useState(""),[d,a]=i.useState([]),[x,c]=i.useState("");i.useEffect(()=>{g()},[]);const g=async()=>{try{const e=await m.get("https://cybitbackend.onrender.com/api/employees");y(e.data.data)}catch(e){console.error("Failed to fetch employees",e)}},u=e=>{l(e),h(e.role),a(e.permissions||[]),c("")},b=async()=>{if(!s){c("Role is required");return}try{await m.put(`https://cybitbackend.onrender.com/api/employees/${r==null?void 0:r._id}/permissionsnew`,{role:s,permissions:d},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),alert("Permissions updated successfully"),l(null),g()}catch(e){c("Failed to update permissions"),console.error(e)}},f=["employee"],k=["todolist","analytics","finance","crypto","notes","Blogs","scrumboard","contacts","invoice/list","invoice/add","expenses/list","expenses/add","Estimation/list","Estimation/add","calendar"];return o("div",{style:{padding:"24px",fontFamily:"Arial, sans-serif",maxWidth:900,margin:"auto"},children:[t("h2",{style:{marginBottom:"16px",textAlign:"center"},children:"Employees List"}),o("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"40px"},children:[t("thead",{children:o("tr",{style:{backgroundColor:"#f0f0f0"},children:[t("th",{style:{border:"1px solid #ddd",padding:"10px"},children:"Employee No."}),t("th",{style:{border:"1px solid #ddd",padding:"10px"},children:"Name"}),t("th",{style:{border:"1px solid #ddd",padding:"10px"},children:"Email"}),t("th",{style:{border:"1px solid #ddd",padding:"10px"},children:"Role"}),t("th",{style:{border:"1px solid #ddd",padding:"10px"},children:"Permissions"}),t("th",{style:{border:"1px solid #ddd",padding:"10px"},children:"Actions"})]})}),o("tbody",{children:[p.map(e=>{var n;return o("tr",{style:{borderBottom:"1px solid #ccc"},children:[t("td",{style:{padding:"10px",textAlign:"center"},children:e.employeeNumber}),t("td",{style:{padding:"10px"},children:e.name}),t("td",{style:{padding:"10px"},children:e.email}),t("td",{style:{padding:"10px",textTransform:"capitalize"},children:e.role}),t("td",{style:{padding:"10px"},children:(n=e.permissions)==null?void 0:n.join(", ")}),t("td",{style:{padding:"10px",textAlign:"center"},children:t("button",{onClick:()=>u(e),style:{padding:"6px 12px",backgroundColor:"#007BFF",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Edit"})})]},e._id)}),p.length===0&&t("tr",{children:t("td",{colSpan:6,style:{padding:"16px",textAlign:"center",color:"#777"},children:"No employees found"})})]})]}),r&&t("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999},onClick:()=>l(null),children:o("div",{onClick:e=>e.stopPropagation(),style:{backgroundColor:"#fafafa",borderRadius:"8px",padding:"20px",width:"400px",boxShadow:"0 2px 10px rgba(0,0,0,0.3)",maxHeight:"90vh",overflowY:"auto"},children:[o("h3",{style:{marginBottom:"16px",textAlign:"center"},children:["Edit Permissions for ",r.name]}),x&&t("div",{style:{color:"red",marginBottom:"12px",fontWeight:"bold",textAlign:"center"},children:x}),o("div",{style:{marginBottom:"20px"},children:[t("label",{htmlFor:"role-select",style:{display:"block",marginBottom:"6px",fontWeight:"600"},children:"Role"}),o("select",{id:"role-select",value:s,onChange:e=>h(e.target.value),style:{width:"100%",padding:"8px",fontSize:"1rem",borderRadius:"4px",border:"1px solid #ccc"},children:[t("option",{value:"",children:"Select role"}),f.map(e=>t("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]})]}),o("fieldset",{style:{border:"1px solid #ddd",padding:"15px",borderRadius:"6px",marginBottom:"20px"},children:[t("legend",{style:{fontWeight:"600",marginBottom:"10px"},children:"Permissions"}),t("small",{style:{display:"block",marginBottom:"15px",color:"#555"},children:"Select the permissions this employee should have."}),k.map(e=>o("label",{style:{display:"block",cursor:"pointer",marginBottom:"10px",userSelect:"none",fontSize:"1rem"},children:[t("input",{type:"checkbox",checked:d.includes(e),onChange:n=>{n.target.checked?a([...d,e]):a(d.filter(v=>v!==e))},style:{marginRight:"10px",transform:"scale(1.2)"}}),e.charAt(0).toUpperCase()+e.slice(1)]},e))]}),o("div",{style:{textAlign:"center"},children:[t("button",{onClick:b,style:{padding:"10px 20px",backgroundColor:"#28a745",border:"none",borderRadius:"5px",color:"white",cursor:"pointer",marginRight:"10px",fontWeight:"600"},children:"Save"}),t("button",{onClick:()=>l(null),style:{padding:"10px 20px",backgroundColor:"#dc3545",border:"none",borderRadius:"5px",color:"white",cursor:"pointer",fontWeight:"600"},children:"Cancel"})]})]})})]})};export{S as default};
